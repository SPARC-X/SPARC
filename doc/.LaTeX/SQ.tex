
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks,c]{} \label{SQ}

\begin{center}
\Huge \textbf{Spectral Quadrature}
\end{center}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\textbf{Comments}} \label{SQ_COMMENTS}
The code will fail with the following options and the related input options are listed.
\begin{itemize}
  \item Polarized calculation: \texttt{SPIN\_TYP}.
  \item K-point calculation: \texttt{KPOINT\_GRID}, \texttt{KPOINT\_SHIFT}.
  \item Dirichlet boundary condition in any direction: \texttt{BC}
  \item Define number of states/orbitals: \texttt{NSTATES}
  \item CS and SQ3 method: \texttt{CS\_FLAG, SQ3\_FLAG}
  \item Hybrid functionals: \texttt{EXCHANGE\_CORRELATION}
  \item Print eigenvalues into file: \texttt{PRINT\_EIGEN}
\end{itemize}


\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_FLAG}} \label{SQ_FLAG}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Integer
\end{block}

\begin{block}{Default}
0
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_FLAG}: 1
\end{block}
\end{columns}

\begin{block}{Description}
Flag to turn on SQ method 
\end{block}

\begin{block}{Remark}
SQ method can not be turned on simultaneously with CS, SQ3, hybrid functionals. 
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_TYPE\_DM}} \label{SQ_TYPE_DM}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
String
\end{block}

\begin{block}{Default}
GAUSS
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_TYPE\_DM}: CC
\end{block}
\end{columns}

\begin{block}{Description}
Flag to choose type of quadrature for density matrix. Available options are Gauss (GAUSS) and Clenshaw-Curtis (CC). 
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_GAUSS\_MEM}} \label{SQ_GAUSS_MEM}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
String
\end{block}

\begin{block}{Default}
LOW
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_GAUSS\_MEM}: HIGH
\end{block}
\end{columns}

\begin{block}{Description}
Flag for memory option when using Gauss quadrature for density matrix. 
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_NPL\_C}} \label{SQ_NPL_C}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Integer
\end{block}

\begin{block}{Default}
\texttt{SQ\_NPL\_G} $\times$ \texttt{SQ\_FAC\_G2C}
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_NPL\_C}: 24
\end{block}
\end{columns}

\begin{block}{Description}
Degree of polynomial for Clenshaw Curtis in forces and stress. 
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_NPL\_G}} \label{SQ_NPL_G}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Integer
\end{block}

\begin{block}{Default}
None
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_NPL\_G}: 24
\end{block}
\end{columns}

\begin{block}{Description}
Degree of polynomial for Gauss Quadrature.
\end{block}

\begin{block}{Remark}
\texttt{SQ\_NPL\_G} must be specified if SQ is turned on.
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{{SQ\_RCUT}}} \label{SQ_RCUT}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Double
\end{block}

\begin{block}{Default}
None
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
Bohr
\end{block}

\begin{block}{Example}
\texttt{SQ\_RCUT}: 2.0
\end{block}
\end{columns}

\begin{block}{Description}
Truncation or localization radius
\end{block}

\begin{block}{Remark}
\texttt{{SQ\_RCUT}} must be specified if SQ is turned on.
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{{SQ\_FAC\_G2C}}} \label{SQ_FAC_G2C}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Double
\end{block}

\begin{block}{Default}
2.0
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_FAC\_G2C}: 3.0
\end{block}
\end{columns}

\begin{block}{Description}
\texttt{SQ\_NPL\_C} = \texttt{SQ\_FAC\_G2C} $\times$ \texttt{SQ\_NPL\_G}. Used if \texttt{SQ\_NPL\_C} is not specified.
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_TOL\_OCC}} \label{SQ_TOL_OCC}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Double
\end{block}

\begin{block}{Default}
$10^{-6}$
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_TOL\_OCC}: 1E-5
\end{block}
\end{columns}

\begin{block}{Description}
Tolerance for occupation corresponding to maximum eigenvalue.
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%




%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_EIGSHIFT\_FLAG}} \label{SQ_EIGSHIFT_FLAG}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Integer
\end{block}

\begin{block}{Default}
0
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{SQ\_EIGSHIFT\_FLAG}: 1
\end{block}
\end{columns}

\begin{block}{Description}
Flag for choosing to use minmax eigenvalues of Gauss for Clenshaw Curtis in forces/stress after shifting by eigshift.
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{SQ\_EIGSHIFT}} \label{SQ_EIGSHIFT}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Double
\end{block}

\begin{block}{Default}
5
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
Percent
\end{block}

\begin{block}{Example}
\texttt{SQ\_EIGSHIFT}: 10
\end{block}
\end{columns}

\begin{block}{Description}
Percentage shift in eigenspectrum.
\end{block}

\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{frame}[allowframebreaks]{\texttt{NP\_DOMAIN\_SQ\_PARAL}} \label{NP_DOMAIN_SQ_PARAL}
\vspace*{-12pt}
\begin{columns}
\column{0.4\linewidth}
\begin{block}{Type}
Integer
\end{block}

\begin{block}{Default}
Automatically optimized
\end{block}

\column{0.4\linewidth}
\begin{block}{Unit}
No unit
\end{block}

\begin{block}{Example}
\texttt{NP\_DOMAIN\_SQ\_PARAL}: 3 3 2
\end{block}
\end{columns}

\begin{block}{Description}
Dimensions of the 3D Cartesian topology for SQ method.
\end{block}

\begin{block}{Remark}
This option is for development purpose. It's better to let SPARC choose the parallization parameters in practice.
\end{block}
\end{frame}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%